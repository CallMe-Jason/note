## 小程序项目整理

### 组件之间的传值

采用小程序的声明式导航或编程式导航将ID带到另一个组件中，在组件中通过onLoad钩子函数中的options参数来获取ID,发送请求拿到数据

### 重置滚动条

切换选项时动态的将scroll-top的值设置为0，但是若初始值为0，在切换时再次设置为0，那么不会触发，所以在切换时通过三元表达式将值设置1或者0，达到目的

### 自定义组件封装click事件

当在自定义组件上使用@click事件时，不会生效，所以需要在组件内给view设置@click事件，再通过$emit来触发自定义组件上的自定义事件

### 搜索组件

触发组件的自定义事件后跳转到搜索组件

根据关键字发送请求返回数据，根据返回数据的长度按需展示历史和搜索列表，点击列表项通过编程式导航将ID传递给要跳转的页面，根据input事件来将搜索的值存到vuex的state中去并持久化

### 购物车

1.点击加入购物车时组织商品信息，包括商品ID，商品名称，商品价格，商品数量，商品图片以及商品选中状态（默认为true)

2.在vuex中声明购物车的数组，在mutations方法中定义函数，使用find方法查询数组中是否有该商品，有的话则数量加一，没有则push进数组中

3.通过vuex中的getters属性，使用reduce统计商品的数量，把统计好的数量映射到商品详情页上，并用侦听器监听数量的变化，采用对象的方式监听该对象使用immediate来在页面初次加载完成后立即调用，并把监听到的新值赋值给info

4.把vuex中的数据持久化存储

5.创建mixins的js文件，把商品的数量映射到该文件中，在onShow中触发函数，该函数中通过setTabBarBadge设置tabBar页面的徽标，混入到其他的tabBar页面

6.通过监听number-box的变化，定义新的Mutations函数来更改vuex中商品数量的值，并重新存储到本地

7.在vuex中的Getters中计算选中商品的数量，用filter方法筛选选中的商品，再用reduce统计商品的数量，映射到组件中使用差值表达式显示出来

8.在vuex中的Getters中计算选中商品的价格，方式同上

9.动态渲染全选按钮的选中状态，需要在计算属性中判断选中的数量和总数量是否相等来返回一个布尔值来渲染全选的选中状态

10.商品的全选和反选，需要在Mutations中定义新的函数来遍历购物车数组，把新的状态赋值给每一项的数组，当点击按钮时，触发此方法，并把自身的状态值取反传递给他

### 选择收货地址

1.点击选择收货地址时，通过chooseAddress方法来自动获取信息，注意，此方法返回的是个promise，可以使用async/await来优化

2.在vuex中定义存储地址的变量，把拿到的地址赋值给vuex中的变量并存到本地

3.如果未授权时，用chooseAddress方法返回的值来判断用户是否授权，未授权则需要去触发一个新的函数，在该函数中用showModal方法来弹出框询问用户是否需要开启权限，判断用户的选择来触发openSetting进入设置面板（新版本的openSetting只能通过用户点击按钮触发,并且取消了chooseAddress的授权，可以直接获取）

### 登录获取用户信息

为登录的按钮绑定open-type="getUserInfo",通过@getuserinfo事件来拿到信息（e.detail.userInfo)获取的信息有头像，昵称等